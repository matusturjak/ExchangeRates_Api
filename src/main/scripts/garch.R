library(readxl)
library(tseries)
library(forecast)
library(fGarch)
eurczk = read_excel("C://diplomovka//ExchangeRates_Api//src//main//scripts//exchange_rates.xlsx")

str(eurczk)

eurczk$rate = as.double(eurczk$rate)
ar = auto.arima(
        diff(c(25.494,25.545,25.515,25.594,25.524,25.535,25.57,25.547,25.521,25.531,25.516,25.447,25.365,25.433,25.399,25.403,25.374,25.381,25.357,25.297,25.33,25.272,25.267,25.192,25.196,25.233,25.23,25.247,25.335,25.358,25.386,25.37,25.37,25.34,25.327,25.318,25.361,25.316,25.337,25.391,25.398,25.418,25.434,25.409,25.404,25.38,25.421,25.427,25.454,25.448,25.471,25.447,25.416,25.415,25.432,25.423,25.422,25.399,25.405,25.446,25.473,25.462,25.425,25.367,25.34,25.327,25.339,25.357,25.335,25.323,25.316,25.307,25.265,25.254,25.303,25.327,25.34,25.408,25.437,25.466,25.472,25.471,25.542,25.601,25.585,25.503,25.518,25.526,25.564,25.498,25.506,25.488,25.551,25.545,25.557,25.59,25.68,25.702,25.813,25.809,25.765,25.731,25.907,25.835,25.797,25.827,25.696,25.653,25.648,25.64,25.795,25.682,25.652,25.711,25.651,25.714,25.739,25.811,25.835,25.863,25.792,25.935,25.9,25.777,26.001,26.02,25.998,26.073,26.028,25.938,25.942,25.858,25.898,25.929,25.938,25.924,25.883,25.875,25.853,25.92,25.875,25.848,25.761,25.675,25.647,25.622,25.624,25.598,25.59,25.589,25.657,25.65,25.606,25.578,25.57,25.635,25.656,25.692,25.705,25.702,25.729,25.706,25.737,25.725,25.713,25.744,25.744,25.713,25.745,25.749,25.735,25.749,25.728,25.746,25.715,25.697,25.648,25.646,25.59,25.52,25.473,25.457,25.448,25.434,25.56,25.585,25.615,25.613,25.605,25.715,25.731,25.765,25.788,25.779,25.78,25.742,25.737,25.805,25.807,25.848,25.777,25.798,25.821,25.843,25.863,25.867,25.848,25.814,25.833,25.831,25.86,25.849,25.87,25.922,25.879,25.782,25.846,25.833,25.88,25.887,25.936,25.942,25.939,25.994,25.985,25.985,26.013,26.032,26.002,25.99,25.954,25.918,25.914,25.931,25.967,25.957,25.921,25.901,25.886,25.89,25.851,25.866,25.845,25.866,25.829,25.794,25.801,25.753,25.765,25.76,25.855,25.916,25.858,25.778,25.724,25.752,25.683,25.653,25.572,25.642,25.629,25.626,25.606,25.561,25.572,25.564,25.537,25.58,25.593,25.612,25.693,25.695,25.697,25.726,25.747,25.802,25.76,25.695,25.728,25.697,25.781,25.809,25.806,25.836,25.871,25.795,25.79,25.709,25.715,25.717,25.679,25.648,25.667,25.653,25.663,25.661,25.601,25.636,25.621,25.623,25.592,25.61,25.641,25.656,25.667,25.668,25.668,25.668,25.616,25.604,25.646,25.648,25.727,25.759,25.769,25.797,25.786,25.802,25.791,25.753,25.724,25.693,25.613,25.634,25.618,25.608,25.606,25.623,25.625,25.663,25.657,25.682,25.743,25.729,25.737,25.705,25.682,25.659,25.648,25.712,25.715,25.731,25.727,25.718,25.732,25.776,25.751,25.76,25.696,25.753,25.766,25.775,25.793,25.821,25.83,25.834,25.843,25.861,25.841,25.816,25.832,25.744,25.657,25.663,25.642,25.626,25.64,25.614,25.581,25.54,25.56,25.609,25.635,25.619,25.609,25.601,25.557,25.486,25.434,25.447,25.478,25.462,25.458,25.434,25.471,25.509,25.543,25.565,25.605,25.59,25.569,25.575,25.603,25.586,25.546,25.534,25.549,25.542,25.519,25.542,25.613,25.65,25.658,25.742,25.763,25.776,25.727,25.719,25.789,25.828,25.831,25.829,25.884,25.876,25.734,25.78,25.796,25.794,25.784,25.769,25.792,25.814,25.844,25.853,25.914,25.919,25.885,25.834,25.853,25.836,25.855,25.869,25.867,25.824,25.843,25.882,25.916,25.892,25.892,25.913,25.89,25.872,25.867,25.851,25.842,25.816,25.74,25.739,25.739,25.741,25.781,25.805,25.823,25.893,25.807,25.823,25.82,25.758,25.673,25.659,25.63,25.57,25.638,25.598,25.568,25.48,25.543,25.512,25.509,25.514,25.511,25.536,25.498,25.534,25.486,25.51,25.499,25.591,25.56,25.583,25.593,25.565,25.541,25.52,25.513,25.485,25.505,25.515,25.574,25.515,25.534,25.527,25.52,25.526,25.533,25.528,25.527,25.522,25.519,25.508,25.483,25.445,25.49,25.473,25.445,25.499,25.485,25.509,25.463,25.408,25.411,25.36,25.301,25.276,25.265,25.253,25.265,25.23,25.155,25.144,25.17,25.147,25.125,25.066,25.136,25.159,25.16,25.231,25.221,25.208,25.25,25.21,25.177,25.143,25.055,24.893,25.03,25.026,24.965,24.878,24.835,24.828,24.793,24.898,24.962,25.037,25.061,25.186,25.226,25.344,25.283,25.39,25.525,25.475,25.34,25.346,25.458,25.504,25.725,25.77,26.203,26.042,26.96,26.985,27.154,27.606,27.191,27.635,27.808,27.446,27.55,27.299,27.315,27.312,27.369,27.553,27.539,27.603,27.215,27.183,26.909,26.864,26.991,27.053,27.163,27.328,27.447,27.534,27.551,27.31,27.184,27.227,27.125,27.097,27.119,26.978,26.987,27.158,27.251,27.6,27.423,27.408,27.571,27.589,27.61,27.49,27.43,27.212,27.21,27.275,27.073,27.051,27.017,26.921,26.859,26.645,26.66,26.623,26.589,26.585,26.634,26.609,26.679,26.698,26.683,26.564,26.561,26.689,26.683,26.681,26.612,26.733,26.796,26.808,26.848,26.74,26.67,26.632,26.665,26.705,26.681,26.748,26.622,26.691,26.648,26.638,26.587,26.693,26.682,26.598,26.429,26.365,26.342,26.268,26.193,26.251,26.291,26.248,26.175,26.319,26.221,26.097,26.202,26.279,26.183,26.155,26.117,26.125,26.118,26.14,26.134,26.118,26.061,26.083,26.091,26.121,26.262,26.276,26.2,26.208,26.226,26.338,26.368,26.435,26.468,26.521,26.519,26.585,26.566,26.66,26.827,26.726,26.747,26.727,26.98,27.007,26.965,27.015,27.107,27.133,27.148,27.233,26.918,27.02,27.096,27.035,27.064,27.092,27.11,27.177,27.356,27.313,27.34,27.279,27.346,27.233,27.185,27.23,27.222,27.295,27.337,27.422,27.368,27.251,27.131,26.913,26.781,26.766,26.667,26.475,26.431,26.447,26.465,26.461,26.353,26.508,26.401,26.358,26.34,26.311,26.258,26.175,26.138,26.213,26.192,26.235,26.411,26.42,26.518,26.482,26.398,26.239,26.307,26.328,26.317,26.361,26.2,26.204,26.139,26.275,26.303,26.372,26.299,26.247,26.302,26.252,26.242,26.141,26.227,26.145,26.147,26.163,26.239,26.19,26.173,26.19,26.163,26.185,26.161,26.125,26.094,26.152,26.08,26.08,26.025,26.114,26.02,25.975,25.9,25.925,25.895,25.806,25.739,25.738,25.835,25.772,25.753,25.682,25.753,25.883,25.864,25.849,25.954,25.906,25.978,26.11,26.195,26.087,26.142,26.138,26.208,26.303,26.417,26.288,26.226,26.154,26.15,26.193,26.197,26.159,26.17,26.127,26.075,26.198,26.206,26.233,26.081,26.079,26.122,26.143,26.085,26.051,25.919,25.875,25.945,26.031,26.016,25.929,25.942,25.927,25.903,25.903,25.893,25.86,25.847,25.807,25.895,25.96,25.817,25.883,25.773,25.841,25.825,25.847,25.682,25.591,25.571,25.522,25.575,25.492,25.498,25.427,25.445,25.519,25.452,25.424,25.447,25.451,25.439,25.451,25.454,25.462,25.465,25.448,25.451,25.4,25.394,25.377,25.391,25.335,25.422,25.45,25.472,25.51,25.519,25.569,25.533,25.408,25.423,25.487,25.499,25.477,25.488,25.507,25.606,25.586,25.61,25.688,25.894,25.791,25.723,25.644,25.646,25.587,25.538,25.605,25.642,25.695,25.639,25.65,25.629,25.685,25.625,25.506,25.501,25.476,25.49,25.44,25.415,25.413,25.391,25.382,25.405,25.393,25.386,25.427,25.441,25.447,25.501,25.559,25.514,25.533,25.531,25.546,25.563,25.566,25.523,25.406,25.382,25.422,25.401,25.423,25.394,25.398,25.288,25.348,25.389,25.318,25.281,25.296,25.432,25.4,25.38,25.35))
)

ar2 = auto.arima(diff(eurczk$rate))

zdb = as.double(c(25.494,25.545,25.515,25.594,25.524,25.535,25.57,25.547,25.521,25.531,25.516,25.447,25.365,25.433,25.399,25.403,25.374,25.381,25.357,25.297,25.33,25.272,25.267,25.192,25.196,25.233,25.23,25.247,25.335,25.358,25.386,25.37,25.37,25.34,25.327,25.318,25.361,25.316,25.337,25.391,25.398,25.418,25.434,25.409,25.404,25.38,25.421,25.427,25.454,25.448,25.471,25.447,25.416,25.415,25.432,25.423,25.422,25.399,25.405,25.446,25.473,25.462,25.425,25.367,25.34,25.327,25.339,25.357,25.335,25.323,25.316,25.307,25.265,25.254,25.303,25.327,25.34,25.408,25.437,25.466,25.472,25.471,25.542,25.601,25.585,25.503,25.518,25.526,25.564,25.498,25.506,25.488,25.551,25.545,25.557,25.59,25.68,25.702,25.813,25.809,25.765,25.731,25.907,25.835,25.797,25.827,25.696,25.653,25.648,25.64,25.795,25.682,25.652,25.711,25.651,25.714,25.739,25.811,25.835,25.863,25.792,25.935,25.9,25.777,26.001,26.02,25.998,26.073,26.028,25.938,25.942,25.858,25.898,25.929,25.938,25.924,25.883,25.875,25.853,25.92,25.875,25.848,25.761,25.675,25.647,25.622,25.624,25.598,25.59,25.589,25.657,25.65,25.606,25.578,25.57,25.635,25.656,25.692,25.705,25.702,25.729,25.706,25.737,25.725,25.713,25.744,25.744,25.713,25.745,25.749,25.735,25.749,25.728,25.746,25.715,25.697,25.648,25.646,25.59,25.52,25.473,25.457,25.448,25.434,25.56,25.585,25.615,25.613,25.605,25.715,25.731,25.765,25.788,25.779,25.78,25.742,25.737,25.805,25.807,25.848,25.777,25.798,25.821,25.843,25.863,25.867,25.848,25.814,25.833,25.831,25.86,25.849,25.87,25.922,25.879,25.782,25.846,25.833,25.88,25.887,25.936,25.942,25.939,25.994,25.985,25.985,26.013,26.032,26.002,25.99,25.954,25.918,25.914,25.931,25.967,25.957,25.921,25.901,25.886,25.89,25.851,25.866,25.845,25.866,25.829,25.794,25.801,25.753,25.765,25.76,25.855,25.916,25.858,25.778,25.724,25.752,25.683,25.653,25.572,25.642,25.629,25.626,25.606,25.561,25.572,25.564,25.537,25.58,25.593,25.612,25.693,25.695,25.697,25.726,25.747,25.802,25.76,25.695,25.728,25.697,25.781,25.809,25.806,25.836,25.871,25.795,25.79,25.709,25.715,25.717,25.679,25.648,25.667,25.653,25.663,25.661,25.601,25.636,25.621,25.623,25.592,25.61,25.641,25.656,25.667,25.668,25.668,25.668,25.616,25.604,25.646,25.648,25.727,25.759,25.769,25.797,25.786,25.802,25.791,25.753,25.724,25.693,25.613,25.634,25.618,25.608,25.606,25.623,25.625,25.663,25.657,25.682,25.743,25.729,25.737,25.705,25.682,25.659,25.648,25.712,25.715,25.731,25.727,25.718,25.732,25.776,25.751,25.76,25.696,25.753,25.766,25.775,25.793,25.821,25.83,25.834,25.843,25.861,25.841,25.816,25.832,25.744,25.657,25.663,25.642,25.626,25.64,25.614,25.581,25.54,25.56,25.609,25.635,25.619,25.609,25.601,25.557,25.486,25.434,25.447,25.478,25.462,25.458,25.434,25.471,25.509,25.543,25.565,25.605,25.59,25.569,25.575,25.603,25.586,25.546,25.534,25.549,25.542,25.519,25.542,25.613,25.65,25.658,25.742,25.763,25.776,25.727,25.719,25.789,25.828,25.831,25.829,25.884,25.876,25.734,25.78,25.796,25.794,25.784,25.769,25.792,25.814,25.844,25.853,25.914,25.919,25.885,25.834,25.853,25.836,25.855,25.869,25.867,25.824,25.843,25.882,25.916,25.892,25.892,25.913,25.89,25.872,25.867,25.851,25.842,25.816,25.74,25.739,25.739,25.741,25.781,25.805,25.823,25.893,25.807,25.823,25.82,25.758,25.673,25.659,25.63,25.57,25.638,25.598,25.568,25.48,25.543,25.512,25.509,25.514,25.511,25.536,25.498,25.534,25.486,25.51,25.499,25.591,25.56,25.583,25.593,25.565,25.541,25.52,25.513,25.485,25.505,25.515,25.574,25.515,25.534,25.527,25.52,25.526,25.533,25.528,25.527,25.522,25.519,25.508,25.483,25.445,25.49,25.473,25.445,25.499,25.485,25.509,25.463,25.408,25.411,25.36,25.301,25.276,25.265,25.253,25.265,25.23,25.155,25.144,25.17,25.147,25.125,25.066,25.136,25.159,25.16,25.231,25.221,25.208,25.25,25.21,25.177,25.143,25.055,24.893,25.03,25.026,24.965,24.878,24.835,24.828,24.793,24.898,24.962,25.037,25.061,25.186,25.226,25.344,25.283,25.39,25.525,25.475,25.34,25.346,25.458,25.504,25.725,25.77,26.203,26.042,26.96,26.985,27.154,27.606,27.191,27.635,27.808,27.446,27.55,27.299,27.315,27.312,27.369,27.553,27.539,27.603,27.215,27.183,26.909,26.864,26.991,27.053,27.163,27.328,27.447,27.534,27.551,27.31,27.184,27.227,27.125,27.097,27.119,26.978,26.987,27.158,27.251,27.6,27.423,27.408,27.571,27.589,27.61,27.49,27.43,27.212,27.21,27.275,27.073,27.051,27.017,26.921,26.859,26.645,26.66,26.623,26.589,26.585,26.634,26.609,26.679,26.698,26.683,26.564,26.561,26.689,26.683,26.681,26.612,26.733,26.796,26.808,26.848,26.74,26.67,26.632,26.665,26.705,26.681,26.748,26.622,26.691,26.648,26.638,26.587,26.693,26.682,26.598,26.429,26.365,26.342,26.268,26.193,26.251,26.291,26.248,26.175,26.319,26.221,26.097,26.202,26.279,26.183,26.155,26.117,26.125,26.118,26.14,26.134,26.118,26.061,26.083,26.091,26.121,26.262,26.276,26.2,26.208,26.226,26.338,26.368,26.435,26.468,26.521,26.519,26.585,26.566,26.66,26.827,26.726,26.747,26.727,26.98,27.007,26.965,27.015,27.107,27.133,27.148,27.233,26.918,27.02,27.096,27.035,27.064,27.092,27.11,27.177,27.356,27.313,27.34,27.279,27.346,27.233,27.185,27.23,27.222,27.295,27.337,27.422,27.368,27.251,27.131,26.913,26.781,26.766,26.667,26.475,26.431,26.447,26.465,26.461,26.353,26.508,26.401,26.358,26.34,26.311,26.258,26.175,26.138,26.213,26.192,26.235,26.411,26.42,26.518,26.482,26.398,26.239,26.307,26.328,26.317,26.361,26.2,26.204,26.139,26.275,26.303,26.372,26.299,26.247,26.302,26.252,26.242,26.141,26.227,26.145,26.147,26.163,26.239,26.19,26.173,26.19,26.163,26.185,26.161,26.125,26.094,26.152,26.08,26.08,26.025,26.114,26.02,25.975,25.9,25.925,25.895,25.806,25.739,25.738,25.835,25.772,25.753,25.682,25.753,25.883,25.864,25.849,25.954,25.906,25.978,26.11,26.195,26.087,26.142,26.138,26.208,26.303,26.417,26.288,26.226,26.154,26.15,26.193,26.197,26.159,26.17,26.127,26.075,26.198,26.206,26.233,26.081,26.079,26.122,26.143,26.085,26.051,25.919,25.875,25.945,26.031,26.016,25.929,25.942,25.927,25.903,25.903,25.893,25.86,25.847,25.807,25.895,25.96,25.817,25.883,25.773,25.841,25.825,25.847,25.682,25.591,25.571,25.522,25.575,25.492,25.498,25.427,25.445,25.519,25.452,25.424,25.447,25.451,25.439,25.451,25.454,25.462,25.465,25.448,25.451,25.4,25.394,25.377,25.391,25.335,25.422,25.45,25.472,25.51,25.519,25.569,25.533,25.408,25.423,25.487,25.499,25.477,25.488,25.507,25.606,25.586,25.61,25.688,25.894,25.791,25.723,25.644,25.646,25.587,25.538,25.605,25.642,25.695,25.639,25.65,25.629,25.685,25.625,25.506,25.501,25.476,25.49,25.44,25.415,25.413,25.391,25.382,25.405,25.393,25.386,25.427,25.441,25.447,25.501,25.559,25.514,25.533,25.531,25.546,25.563,25.566,25.523,25.406,25.382,25.422,25.401,25.423,25.394,25.398,25.288,25.348,25.389,25.318,25.281,25.296,25.432,25.4,25.38,25.35))

diffZdb = diff(zdb);
arDiff = auto.arima(diffZdb)
arDiff
#plot(zdb[750:800], type="l")
#lines(eurczk$rate[750:800], type="l",col="green")

modelGarch = garchFit(~arma(1,3)+garch(1,1), data = diffZdb)
#plot(modelGarch@fitted, type="l")

predikcieGJRGarch = 0;

predikcieGJRGarch[1] = zdb[1];
for (i in 1:length(diffZdb)) {
  predikcieGJRGarch[i+1] = zdb[i] + modelGarch@fitted[i];
}
plot(predikcieGJRGarch[1:3], type="l",col ="red")
#lines(zdb[1:3], type="l", col="green")